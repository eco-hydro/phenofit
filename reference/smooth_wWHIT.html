<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Weigthed Whittaker Smoother — smooth_wWHIT • phenofit</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Weigthed Whittaker Smoother — smooth_wWHIT"><meta property="og:description" content="Weigthed Whittaker Smoother"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phenofit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/phenofit-procedures.html">Detailed procedures of phenofit</a>
    </li>
    <li>
      <a href="../articles/phenofit_CA-NS6.html">Extract vegetation phenology from MOD13A1 EVI</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/eco-hydro/phenofit/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Weigthed Whittaker Smoother</h1>
    <small class="dont-index">Source: <a href="https://github.com/eco-hydro/phenofit/blob/HEAD/R/smooth_wWHIT.R" class="external-link"><code>R/smooth_wWHIT.R</code></a></small>
    <div class="hidden name"><code>smooth_wWHIT.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Weigthed Whittaker Smoother</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smooth_wWHIT</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">w</span>,</span>
<span>  <span class="va">ylu</span>,</span>
<span>  <span class="va">nptperyear</span>,</span>
<span>  wFUN <span class="op">=</span> <span class="va">wTSM</span>,</span>
<span>  iters <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  second <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>y</dt>
<dd><p>Numeric vector, vegetation index time-series</p></dd>


<dt>w</dt>
<dd><p>(optional) Numeric vector, weights of <code>y</code>. If not specified,
weights of all <code>NA</code> values will be <code>wmin</code>, the others will be 1.0.</p></dd>


<dt>ylu</dt>
<dd><p><code>[low, high]</code> of time-series y (curve fitting values are constrained
in the range of <code>ylu</code>.</p></dd>


<dt>nptperyear</dt>
<dd><p>Integer, number of images per year.</p></dd>


<dt>wFUN</dt>
<dd><p>weights updating function, can be one of 'wTSM', 'wChen' and
'wBisquare'.</p></dd>


<dt>iters</dt>
<dd><p>How many times curve fitting is implemented.</p></dd>


<dt>lambda</dt>
<dd><p>scaler or numeric vector, whittaker parameter.</p><ul><li><p>If <code>lambda = NULL</code>, <code>V-curve</code> theory will be applied to retrieve the optimal <code>lambda</code>.</p></li>
<li><p>If multiple <code>lambda</code> provided (numeric vector), a list of the smoothing results
with the same length of <code>lambda</code> will be returned.</p></li>
</ul></dd>


<dt>second</dt>
<dd><p>If true, in every iteration, Whittaker will be implemented
twice to make sure curve fitting is smooth. If curve has been smoothed
enough, it will not care about the second smooth. If no, the second one is
just prepared for this situation. If lambda value has been optimized, second
smoothing is unnecessary.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters are passed to <code>wFUN</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<ul><li><p><code>ws</code>: weights of every iteration</p></li>
<li><p><code>zs</code>: curve fittings of every iteration</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>Whittaker smoother of the second order difference is used!</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ol><li><p>Eilers, P.H.C., 2003. A perfect smoother. Anal. Chem. <a href="https://doi.org/10.1021/ac034173t" class="external-link">doi:10.1021/ac034173t</a></p></li>
<li><p>Frasso, G., Eilers, P.H.C., 2015. L- and V-curves for optimal smoothing. Stat.
Modelling 15, 91-111. <a href="https://doi.org/10.1177/1471082X14549288" class="external-link">doi:10.1177/1471082X14549288</a>
.</p></li>
</ol></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="lambda_vcurve.html">lambda_vcurve()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"MOD13A1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="tidy_MOD13.html">tidy_MOD13</a></span><span class="op">(</span><span class="va">MOD13A1</span><span class="op">$</span><span class="va">dt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">[</span><span class="va">site</span> <span class="op">==</span> <span class="st">"AT-Neu"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="check_input.html">check_input</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">t</span>, <span class="va">d</span><span class="op">$</span><span class="va">y</span>, <span class="va">d</span><span class="op">$</span><span class="va">w</span>, nptperyear<span class="op">=</span><span class="fl">23</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r_wWHIT</span> <span class="op">&lt;-</span> <span class="fu">smooth_wWHIT</span><span class="op">(</span><span class="va">l</span><span class="op">$</span><span class="va">y</span>, <span class="va">l</span><span class="op">$</span><span class="va">w</span>, <span class="va">l</span><span class="op">$</span><span class="va">ylu</span>, nptperyear <span class="op">=</span> <span class="fl">23</span>, iters <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Optimize `lambda` by V-curve theory</span></span></span>
<span class="r-in"><span><span class="co"># (a) optimize manually</span></span></span>
<span class="r-in"><span><span class="fu"><a href="lambda_vcurve.html">lambda_vcurve</a></span><span class="op">(</span><span class="va">l</span><span class="op">$</span><span class="va">y</span>, <span class="va">l</span><span class="op">$</span><span class="va">w</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="smooth_wWHIT-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.912509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vcurve</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lg_lambda         v</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:      0.15 0.7884322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:      0.25 0.7440285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:      0.35 0.7060863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:      0.45 0.6750716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:      0.55 0.6504026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:      0.65 0.6309297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:      0.75 0.6156428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:      0.85 0.6043848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:      0.95 0.5982948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:      1.05 0.5997682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:      1.15 0.6119080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:      1.25 0.6376537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:      1.35 0.6788940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:      1.45 0.7358517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:      1.55 0.8069273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:      1.65 0.8890535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:      1.75 0.9784316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:      1.85 1.0713447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:      1.95 1.1647063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:      2.05 1.2561877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:      2.15 1.3440350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:      2.25 1.4268234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:      2.35 1.5033215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:      2.45 1.5724867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:      2.55 1.6335145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26:      2.65 1.6858644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27:      2.75 1.7292301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28:      2.85 1.7634668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29:      2.95 1.7885161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30:      3.05 1.8043706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31:      3.15 1.8111132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32:      3.25 1.8090421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33:      3.35 1.7988609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34:      3.45 1.7818688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35:      3.55 1.7600540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36:      3.65 1.7359930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37:      3.75 1.7125168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38:      3.85 1.6922088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39:      3.95 1.6768950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40:      4.05 1.6673013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41:      4.15 1.6629799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42:      4.25 1.6624863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43:      4.35 1.6636941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44:      4.45 1.6641116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45:      4.55 1.6610975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46:      4.65 1.6519428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47:      4.75 1.6338408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48:      4.85 1.6038159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49:      4.95 1.5587223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lg_lambda         v</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (b) optimize automatically by setting `lambda = NULL` in smooth_wWHIT</span></span></span>
<span class="r-in"><span><span class="va">r_wWHIT2</span> <span class="op">&lt;-</span> <span class="fu">smooth_wWHIT</span><span class="op">(</span><span class="va">l</span><span class="op">$</span><span class="va">y</span>, <span class="va">l</span><span class="op">$</span><span class="va">w</span>, <span class="va">l</span><span class="op">$</span><span class="va">ylu</span>, nptperyear <span class="op">=</span> <span class="fl">23</span>, iters <span class="op">=</span> <span class="fl">2</span>, lambda <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># </span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dongdong Kong, Mingzhong Xiao, Yongqiang Zhang, Xihui Gu, Jianjian Cui.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

