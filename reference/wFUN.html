<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Weight updating functions — wSELF • phenofit</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Weight updating functions — wSELF"><meta property="og:description" content="

wSELF weigth are not changed and return the original.
wTSM weight updating method in TIMESAT.
wBisquare Bisquare weight update method. wBisquare has been
modified to emphasis on upper envelope.
wBisquare0 Traditional Bisquare weight update method.
wChen Chen et al., (2004) weight updating method.
wBeck Beck et al., (2006) weigth updating method. wBeck need
sos and eos input. The function parameter is different from others. It is
still not finished.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phenofit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/phenofit_CA-NS6.html">Extract vegetation phenology from MOD13A1 EVI</a>
    </li>
    <li>
      <a href="../articles/phenofit-procedures.html">Detailed procedures of phenofit</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/eco-hydro/phenofit/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Weight updating functions</h1>
    <small class="dont-index">Source: <a href="https://github.com/eco-hydro/phenofit/blob/master/R/wFUN.R" class="external-link"><code>R/wFUN.R</code></a></small>
    <div class="hidden name"><code>wFUN.Rd</code></div>
    </div>

    <div class="ref-description">

<ul><li><p><code>wSELF</code> weigth are not changed and return the original.</p></li>
<li><p><code>wTSM</code> weight updating method in TIMESAT.</p></li>
<li><p><code>wBisquare</code> Bisquare weight update method. wBisquare has been
modified to emphasis on upper envelope.</p></li>
<li><p><code>wBisquare0</code> Traditional Bisquare weight update method.</p></li>
<li><p><code>wChen</code> Chen et al., (2004) weight updating method.</p></li>
<li><p><code>wBeck</code> Beck et al., (2006) weigth updating method. wBeck need
sos and eos input. The function parameter is different from others. It is
still not finished.</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wSELF</span><span class="op">(</span><span class="va">y</span>, <span class="va">yfit</span>, <span class="va">w</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wTSM</span><span class="op">(</span><span class="va">y</span>, <span class="va">yfit</span>, <span class="va">w</span>, iter <span class="op">=</span> <span class="fl">2</span>, <span class="va">nptperyear</span>, wfact <span class="op">=</span> <span class="fl">0.5</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wBisquare0</span><span class="op">(</span><span class="va">y</span>, <span class="va">yfit</span>, <span class="va">w</span>, <span class="va">...</span>, wmin <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wBisquare</span><span class="op">(</span><span class="va">y</span>, <span class="va">yfit</span>, <span class="va">w</span>, <span class="va">...</span>, wmin <span class="op">=</span> <span class="fl">0.2</span>, .toUpper <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wChen</span><span class="op">(</span><span class="va">y</span>, <span class="va">yfit</span>, <span class="va">w</span>, <span class="va">...</span>, wmin <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wKong</span><span class="op">(</span><span class="va">y</span>, <span class="va">yfit</span>, <span class="va">w</span>, <span class="va">...</span>, wmin <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Numeric vector, vegetation index time-series</p></dd>


<dt id="arg-yfit">yfit<a class="anchor" aria-label="anchor" href="#arg-yfit"></a></dt>
<dd><p>Numeric vector curve fitting values.</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>(optional) Numeric vector, weights of <code>y</code>. If not specified,
weights of all <code>NA</code> values will be <code>wmin</code>, the others will be 1.0.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other parameters are ignored.</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>iteration of curve fitting.</p></dd>


<dt id="arg-nptperyear">nptperyear<a class="anchor" aria-label="anchor" href="#arg-nptperyear"></a></dt>
<dd><p>Integer, number of images per year.</p></dd>


<dt id="arg-wfact">wfact<a class="anchor" aria-label="anchor" href="#arg-wfact"></a></dt>
<dd><p>weight adaptation factor (0-1), equal to the reciprocal of
'Adaptation strength' in TIMESAT.</p></dd>


<dt id="arg-wmin">wmin<a class="anchor" aria-label="anchor" href="#arg-wmin"></a></dt>
<dd><p>Double, minimum weight of bad points, which could be smaller
the weight of snow, ice and cloud.</p></dd>


<dt id="arg--toupper">.toUpper<a class="anchor" aria-label="anchor" href="#arg--toupper"></a></dt>
<dd><p>Boolean. Whether to approach the upper envelope?</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>wnew Numeric Vector, adjusted weights.</p>
    </div>
    <div id="references">
    <h2>References</h2>

<ol><li><p>Per J\"onsson, P., Eklundh, L., 2004. TIMESAT - A program for analyzing
time-series of satellite sensor data. Comput. Geosci. 30, 833-845.
https://doi.org/10.1016/j.cageo.2004.05.006. <br></p></li>
<li><p>https://au.mathworks.com/help/curvefit/smoothing-data.html#bq_6ys3-3 <br></p></li>
<li><p>Garcia, D., 2010. Robust smoothing of gridded data in one and higher
dimensions with missing values. Computational statistics &amp; data analysis,
54(4), pp.1167-1178. <br></p></li>
<li><p>Chen, J., J\"onsson, P., Tamura, M., Gu, Z., Matsushita, B., Eklundh, L.,
2004. A simple method for reconstructing a high-quality NDVI time-series
data set based on the Savitzky-Golay filter. Remote Sens. Environ. 91,
332-344. https://doi.org/10.1016/j.rse.2004.03.014. <br></p></li>
<li><p>Beck, P.S.A., Atzberger, C., Hogda, K.A., Johansen, B., Skidmore, A.K.,
2006. Improved monitoring of vegetation dynamics at very high latitudes:
A new method using MODIS NDVI. Remote Sens. Environ.
https://doi.org/10.1016/j.rse.2005.10.021 <br></p></li>
<li><p>https://github.com/kongdd/phenopix/blob/master/R/FitDoubleLogBeck.R</p></li>
</ol></div>
    <div id="author">
    <h2>Author</h2>
    <p>wTSM is implemented by Per J\"onsson, Malm\"o University, Sweden
<a href="mailto:per.jonsson@ts.mah.se">per.jonsson@ts.mah.se</a> and Lars Eklundh, Lund University, Sweden
<a href="mailto:lars.eklundh@nateko.lu.se">lars.eklundh@nateko.lu.se</a>.
And Translated into Rcpp by Dongdong Kong, 01 May 2018.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dongdong Kong, Mingzhong Xiao, Yongqiang Zhang, Xihui Gu, Jianjian Cui.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

